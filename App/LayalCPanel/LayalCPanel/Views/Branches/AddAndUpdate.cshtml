@{
    ViewBag.Title = Token.AddNewBranch;
    Layout = "~/Views/Shared/_Layout.cshtml";
    UsersPrivilegeVM Priv =
        new UsersPrivilegesBLL().SelectByUserId(PagesEnum.Branches);

}

<div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor" ng-controller="branchesCtrl">
    <!-- begin:: Subheader -->
    <div class="kt-subheader   kt-grid__item" id="kt_subheader">
        <div class="kt-subheader__main">
            <span class="kt-subheader__separator kt-hidden"></span>
            <div class="kt-subheader__breadcrumbs">
                <a href="~/Home/Index" class="kt-subheader__breadcrumbs-home"><i class="flaticon-home"></i></a>

                <span class="kt-subheader__breadcrumbs-separator"></span>
                <a href="~/Home/Index" class="kt-subheader__breadcrumbs-link"> @Token.HomePage </a>

                <span class="kt-subheader__breadcrumbs-separator"></span>
                <a href="~/Branches" class="kt-subheader__breadcrumbs-link"> @Token.Branches </a>


                <span class="kt-subheader__breadcrumbs-separator"></span>
                <a href="javascript:void(0)" class="kt-subheader__breadcrumbs-link" ng-if="branch.State!=state.update">@Token.AddNewBranch</a>
                <a href="javascript:void(0)" class="kt-subheader__breadcrumbs-link" ng-if="branch.State==state.update">@Token.UpdateBranch</a>

                <!-- <span class="kt-subheader__breadcrumbs-link kt-subheader__breadcrumbs-link--active">Active link</span> -->
            </div>
        </div>

    </div>
    <!-- end:: Subheader -->
    <div class="kt-content  kt-grid__item kt-grid__item--fluid">
        <div class="row">
            <div class="col-lg-12">
                <!--AddBranch-->
                <div class="kt-portlet">
                    <div class="kt-portlet__head">
                        <div class="kt-portlet__head-label">
                            <span class="kt-portlet__head-icon">
                                <i class="kt-font-brand flaticon-add"></i>
                            </span>
                            <h3 class="kt-portlet__head-title" ng-if="branch.State!=state.update">@Token.AddNewBranch</h3>
                            <h3 class="kt-portlet__head-title" ng-if="branch.State==state.update">@Token.UpdateBranch</h3>
                        </div>

                    </div>
                    <!--AddBranch Form-->
                    <form novalidate name="branchFrm" class="kt-form kt-form--label-right" ng-submit="saveChange(branchFrm,Branch)">
                        <div class="kt-portlet__body">
                            <!--R O W 1-->
                            <div class="form-group  row">
                                <!--NameAr-->
                                <label class="col-form-label col-lg-2">@Token.NameAr</label>
                                <div class="col-lg-4 form-group-sub">
                                    <input type="text"
                                           name="nameAr"
                                           class="form-control"
                                           ng-class="{'is-invalid':branchFrm.nameAr.$invalid&&branchFormSubmitErro}"
                                           ng-model="branch.NameAr"
                                           maxlength="50"
                                           ng-required="true" />
                                    <!--Errors:-->
                                    <small class="error invalid-feedback" ng-if="branchFrm.nameAr.$error.required&&branchFormSubmitErro">@Token.FieldIsRequierd</small>
                                    <small class="error invalid-feedback" ng-if="branchFrm.isoCnameArode.$error.maxlength&&branchFormSubmitErro">@Token.MaxLengthCharIs 50</small>
                                </div>
                                <!--NameEn-->
                                <label class="col-form-label col-lg-2">@Token.NameEn</label>
                                <div class="col-lg-4 form-group-sub">
                                    <input type="text"
                                           name="nameEn"
                                           class="form-control"
                                           ng-class="{'is-invalid':branchFrm.nameEn.$invalid&&branchFormSubmitErro}"
                                           ng-model="branch.NameEn"
                                           ng-required="true"
                                           maxlength="50" />

                                    <!--Errors:-->
                                    <small class="error invalid-feedback" ng-if="branchFrm.nameEn.$error.required&&branchFormSubmitErro">@Token.FieldIsRequierd</small>
                                    <small class="error invalid-feedback" ng-if="branchFrm.nameEn.$error.maxlength&&branchFormSubmitErro">@Token.MaxLengthCharIs 50</small>
                                </div>
                            </div>

                            <!--R O W 2-->
                            <div class="form-group  row">
                                <!--PhoneNumber-->
                                <label class="col-form-label col-lg-2">@Token.PhoneNumber</label>
                                <div class="col-lg-4 form-group-sub">
                                    <input type="text"
                                           name="phoneNo"
                                           ng-class="{'is-invalid':branchFrm.phoneNo.$invalid&&branchFormSubmitErro}"
                                           class="form-control"
                                           ng-model="branch.PhoneNo"
                                           pattern="[0-9]{1,14}"
                                           ng-required="true" />
                                    <!--Errors:-->
                                    <small class="error invalid-feedback" ng-if="branchFrm.phoneNo.$error.required&&branchFormSubmitErro">@Token.FieldIsRequierd</small>
                                    <small class="error invalid-feedback" ng-if="branchFrm.phoneNo.$error.maxlength&&branchFormSubmitErro">@Token.MaxLengthCharIs 50</small>
                                </div>
                                <!--Address-->
                                <label class="col-form-label col-lg-2">@Token.Address</label>
                                <div class="form-group-sub col-4">
                                    <textarea type="text"
                                              name="address"
                                              ng-class="{'is-invalid':branchFrm.address.$invalid&&branchFormSubmitErro}"
                                              class="form-control "
                                              ng-model="branch.Address"
                                              rows="3"
                                              maxlength="250"
                                              ng-required="true"></textarea>
                                    <!--Errors:-->
                                    <small class="error invalid-feedback" ng-if="branchFrm.address.$error.required&&branchFormSubmitErro">@Token.FieldIsRequierd</small>
                                    <small class="error invalid-feedback" ng-if="branchFrm.address.$error.maxlength&&branchFormSubmitErro">@Token.MaxLengthCharIs 50</small>

                                </div>
                            </div>

                            <!--R O W 3-->
                            <div class="form-group  row">
                                <!--Country-->
                                <label class="col-form-label col-lg-2">@Token.Country</label>
                                <div class="col-lg-4 form-group-sub">
                                    <select class="form-control"
                                            serchbale
                                            name="country"
                                            ng-class="{'is-invalid':branchFrm.emp.$invalid&&branchFormSubmitErro}"
                                            ng-model="branch.CountryId"
                                            ng-options="c.Id as c.CountryName for c in countries"
                                            ng-required="true"></select>
                                    <!--Errors:-->
                                    <small class="error invalid-feedback" ng-if="branchFrm.country.$error.required&&branchFormSubmitErro">@Token.FieldIsRequierd</small>
                                </div>

                                <!--City-->
                                <label class="col-form-label col-lg-2">@Token.City</label>
                                <div class="col-lg-4 form-group-sub">
                                    <select class="form-control"
                                            serchbale
                                            name="city"
                                            ng-class="{'is-invalid':branchFrm.city.$invalid&&branchFormSubmitErro}"
                                            ng-model="branch.CityId"
                                            ng-options="c.Id as c.CityName for c in cities|filter:{'CountryId':branch.CountryId}"
                                            ng-required="true"></select>
                                    <!--Errors:-->
                                    <small class="error invalid-feedback" ng-if="branchFrm.city.$error.required&&branchFormSubmitErro">@Token.FieldIsRequierd</small>
                                </div>
                            </div>


                            <!--R O W 4-->
                            <div class="form-group  row">
                                <!--IsBasic
                                    لا يمكن الغاء التفعيل من هنا 
                                    لان هذا يعنى اذا قام بـ الغاء التفعيل فسوف يصبح البرنامج بلا فرع رئيسى وهذا خطاء
                                    والحل انة يذهب الى اى فرع آخ ويقوم بتفعيلة وسوف تصبح الفروع الاخرى كلها غير مفعلة
                                    -->
                                <label class="col-form-label col-lg-2">@Token.IsBasic</label>
                                <div class="col-lg-4 form-group-sub">
                                    <span class="kt-switch kt-switch--outline kt-switch--icon kt-switch--success">
                                        <label   title="@(LanguageService.IsEn?"The main branch is only one branch at the level of the program and one of the most important use in the archive of albums in the main branch":"الفرع الرئيس هوا فرع واحد فقط على مستوى البرنامج ومن اهم استخدامتة فى ارشفة الالبومات فى الفرع الرئيسى")">
                                            <input type="checkbox" checked="checked" ng-model="branch.IsBasic"
                                                    name="" class="ng-pristine ng-untouched ng-valid ng-not-empty" 
                                                   ng-disabled="isBasicDisabled"/>
                                            <span></span>
                                        </label>
                                    </span>
                                </div>
                            </div>


                        </div>
                        <div class="kt-portlet__foot">
                            <div class="kt-form__actions">
                                <div class="row">
                                    <div class="col-lg-9"></div>
                                    <div class="col-lg-3">
                                        @if (Priv.CanEdit)
                                        {

                                            <button type="submit" class="btn btn-brand btn-elevate btn-elevate-air"
                                                    ng-if="branch.State==state.update">
                                                <i class="la la-save">@Token.Save</i>
                                            </button>
                                        }
                                        @if (Priv.CanAdd)
                                        {
                                            <button type="submit" class="btn btn-brand btn-elevate btn-elevate-air"
                                                    ng-if="branch.State!=state.update">
                                                <i class="la la-save">@Token.Add</i>
                                            </button>

                                        }
                                        <button type="reset" class="btn btn-warning btn-elevate btn-elevate-air" ng-if="branch.State!=state.update" ng-click="reSelect()"><i class="la la-file">@Token.Cancel</i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!--end::Portlet-->
            </div>
        </div>
    </div>

</div>
@section scripts{
    <!--(ANageeb) link angualr files for thsis  view -->
    <script src="~/Scripts/angularJS/views/branches/addAndUpdate/service.js"></script>
    <script src="~/Scripts/angularJS/views/branches/addAndUpdate/contoller.js"></script>
}